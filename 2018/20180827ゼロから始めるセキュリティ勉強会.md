# ゼロから始めるセキュリティ勉強会

## 概要
* 日時: 2018/08/27
* 場所: Weeyble


## session

-----
### 最近の有名なセキュリティ事案の解説
* Speeker: ytakahashi1228

#### S総研事件
* 不正アクセスを受け情報流出
##### 侵入システム
* メール(office365)
* 独自内部システム
##### 侵入方法
* ブルートフォース攻撃によるパスワードクラッキング
##### タイムライン
* パスワード解析
* 内部システムへ侵入
* ログイン履歴発見
* 対策本部設置
* 外部接続遮断
* ネットワーク機器初期化
* 外部接続再開
* 警視庁へ被害届
* 調査委員会設置
* 報告書公開
##### クラック
* 1.メールシステムへの侵入
  - ２回の攻撃を通じてID、PASSを入手
    - おそらく簡単なパスワードがやられた
  - メールおよび添付ファイル入手
    - 入手したIDでブルートフォース
* 2.外部レンタルサーバへの侵入
  - 内部ネットワーク上の複数のOSを遠隔操作する機能が外部に存在
    - マルウェアを仕込まれた
* 3.内部システムへの侵入
  - ファイル共有システムがメールと同じID/PASSだった
  - 管理パスワードが平文保管されてた
##### 被害状況
* 共同研究208件流出
  - 未公開120件
* 個人情報
##### 被害拡大の要因
* システム・機器の問題
  - メールがID/PASSのみで外部からログイン可能
  - 外部サーバが内部サーバを遠隔操作可能
  - 内部ネットワークが広域でフラットな構成
  - 管理者ネットワーク内の一部サーバにアクセス制限無し
* パスワード・暗号鍵の管理の問題
  - 安易なパスワード
  - 管理パスワードが監視用サーバに平文で保管
  - 暗号化キーに単純な文字列
* 外部委託業者管理の問題
  - 監査も未実施
  - 委託先の能力について未評価
##### まとめ
  - しっかりとセキュリティを意識した設計・開発・運用をしましょう

-----
### プログラムの静的解析
* Speeker: kmrr(田口)

#### 静的解析
##### なぜする？
* マルウェアやういするは実行形式
* どのような意図を持ったプログラムなのかを把握するため

#### 静的解析方法
* IDA
  - HexRay社
  - アセンブリくらいまではFree版でもやってくれる
* ILSpy
  - .NetFrameworkプログラムの解析が得意

#### サンプル解析

#### まとめ
* 言語とツールの組み合わせによっては元に近い状態まで解析ができる
* 書かれた言語によってはデコンパイルできないものもある


-----
### ヘッダでできるセキュリティ
* Speeker: nachos(夏山京大)

#### ヘッダ
* headerによるセキュリティ対策の重要性が増えてきている
  - クリックジャッキング
  - CORS
  - OWASP SecurityHeaderProject

#### Webアプリセキュリティ対策
* セキュアプログラミング
  - 本質的な対策が可能
  - セキュリティ設計と漏れの無い実装が必要
* WAF、IPS
  - ゲートウェイ等に設置すれば配下のAPPを防御可能
  - アプリケーション独自の脆弱性には貧弱
  - デフォルトのシグネチャだけだと結構回避して攻撃可能なものが多い
  - 機器導入・運用コストが高い
* セキュリティヘッダ設定
  - 一部の脆弱性の被害緩和を容易に実現可能
  - Webサーバ設定のみ
  - ユーザ環境に依存するため、保険的対策
#### HEADER
* 送信されるデータの先頭に置かれる付加データ

#### 主な防御対象
* クリックジャッキング
* XSS
* 中間者攻撃(STS)

#### クリックジャッキング
* X-Frame-Options
  - 読み込むフレームのサイトを制限する
#### XSS
* X-XSS-Protection
  - ブラウザが持つXSS対策機能を有効にする
* X-Content-SecurityPolicy
* X-WebKit-Policy
* Content-Security-Policy
  - 信頼していないドメインからのスクリプトを実行させない
* X-Content-Type-Options
  - ブラウザが余計な親切をしないようにする
#### STS
* Strict-Transport-Security
  - httpアクセスさせられてもブラウザ側でhttpsでアクセスさせる
#### 設定
* .htaccess等で設定可能

-----
### ハニーポットの魅力
* Speeker: @wato_dn

#### ハニーポット
* 不正アクセスをわざと受けるサイト
#### 型
* 高対話型
  - 実態
* 低対話型
  - エミュレート
#### 楽しみ方
* 検知(log)
* 分析(仮説)
* 答え合わせ(別の人の見解)
### やる場所
* 自宅
  - 柔軟に設定可能
  - セキュアな環境が必須
  - 電気代がかかる
* クラウド
  - 好きな地域に立てられる
  - AWSのこと調べてるだけで1日かかる
* さくらVPS
  - 費用が固定
  - 日本限定
#### 種類
* T-POT
  - 色々な機能の詰め合わせ
  - UIがいい
  - 要求スペックが高いので運用費用が高い
* WOWHoneypot
  - 日本製
  - シンプル
  - 運用費用が安い
#### 注意
* Honeypotの放置はやめましょう
  - 乗っ取り注意
#### まとめ
* 攻撃の傾向に興味があるならやってみよう


-----
### アルティメットサイバーセキュリティークイズに参加した話
* Speeker: 木幡周平

#### アルティメットサイバーセキュリティークイズ
* 7/14 大阪
* 参加者: 118名
#### 予選
* マルバツ形式
#### 準決勝
* 記述式
#### 決勝
* 早押し

#### まとめ
* 簡単な問題が以外に多かった
  - 関連法律、時事ニュース
* 敗退しても問題が為になる


-----
### データベースのセキュリティについて
* Speeker: makaaso(川畑)

#### 5つのポイント
* 共有アカウントは使わない
  - 誰がアクセスできるのかの判断が困難
  - アクセスできる必要のない人がアクセスできてしまう
  - 操作ログでも誰ががわからなくなる
  - 個人アカウントを作成して使用すること
  - アカウント払い出しワークフローを作成する
* 重要な情報は集中管理
  - セキュリティ対策コストが台数分必要となってしまう
  - アクセス経路の把握にコストがかかる
  - 共通基盤の導入をおこなう
    - マイクロサービス、API経由など
* 不要な権限は使わない
  - アクセスコントロールを適切に行う
  - 内部の不正や外部攻撃による乗っ取りの危惧
  - アカウント権限を必要最小限にする
* データベース操作ログをとる
  - インシデントが発生した場合に調査で必要
  - 定期的にチェックすることによりインシデントを未然に帽子
  - アプリケーションレイヤーで取得するようにする
  - RDBMSの機能を使用
    - 負荷になるので取得データ限定が必要
* データを暗号化する
  - データ漏洩の可能性
    - 通信傍受
    - RDBMSファイルへの不正アクセス
  - 通信の暗号化をする
  - RDBMSファイルの暗号化をする
#### まとめ
* ポイントは一般的なセキュリティ対策と同じ
  - アカウント管理
  - アクセス制御
  - 暗号化
  - 監査
* アプリケーションレイヤーで実施しているセキュリティ対策と同様の対策がDBでも必要


-----
### CSS Injection++
* Speeker: @lmt_swallow
* 資料: https://speakerdeck.com/lmt_swallow/css-injection-plus-plus-ji-cun-shou-fa-falsegai-guan-todui-ce

#### CSS Injection
* 任意のCSSファイルのインポート
* <style>をエスケープなしで挿入できる
  - <script>も表示させることができる
  - 該当する要素をbackground: url()みたいな形で送信できる
#### 被害
* 属性値をリーク
  - セッション値など
* タグ内部の値をリーク
* タグ内部の文字種を絞る/順序を知る

#### 攻撃経路
* UserPassword
#### 対策
* クライアント側対策
  - style-srcディレクティブ
*

-----
### OSコマンドインジェクション
* Speeker: tokoroten(日留川)

#### OSコマンドインジェクション
* クライアントからのデータ入力等を受け付けるWebサイトで、プログラムに与えるパラメータにOSに対するコマンドを紛れ込ませて操作する
#### まとめ
* 存在した時点で壊滅的な脆弱性
  - バックドアの設置が可能
* 同じようなフレームやミドルウェアでコマンドが動いてしまう脆弱性も気をつけなければいけない
  - struts2
* FWを正しく使うことが安全で安心化できると思っている。
* メンテナンスを続けていくことが重要
* 一度作ったものは最後まで責任をもって対応しましょう。
